// prisma/schema.prisma

generator client {
  provider   = "prisma-client-js"
  output   = "../node_modules/.prisma/client" 
  engineType = "client"
}

datasource db {
  provider = "postgresql"
}

enum Role {
  ADMIN
}

enum TipoEvento {
  PENDIENTE
  EN_CURSO
  FINALIZADO
  CANCELADO
  MASIVO
  ESCOLAR
}

enum Area {
  COWORKING
  AUDITORIO
  LABORATORIO
  AULA_1
  AULA_2
  AULA_3
  AULA_4
  AULA_5
  AULA_6
  RECEPCION_ESTE
  RECEPCION_OESTE
  EXPLANADA
  PLAZA
  SALA_REUNIONES
}

model User {
  id        String   @id @default(uuid())
  nombre    String
  email     String   @unique
  password  String
  rol       Role     @default(ADMIN)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  
  // Relación: eventos creados por este usuario
  eventosCreados Event[]

  @@map("users")
}

model Event {
  id                  String      @id @default(uuid())
  titulo              String
  descripcion         String?     // Ahora es opcional
  informacion         String      @db.Text
  fechaDesde          DateTime
  fechaHasta          DateTime
  horaDesde           String      // formato HH:mm
  horaHasta           String      // formato HH:mm
  tipoEvento          TipoEvento  @default(PENDIENTE)
  area                Area
  
  // Nuevos campos
  organizadorSolicitante String
  coberturaPrensaBol     Boolean   @default(false)
  anexos                 String[]  @default([]) // Array de links
  contactoFormal         String
  contactoInformal       String?
  convocatoria           Int       @default(0)
  
  createdAt           DateTime    @default(now())
  updatedAt           DateTime    @updatedAt
  
  // Relación: usuario que creó el evento
  createdById String
  createdBy   User        @relation(fields: [createdById], references: [id], onDelete: Cascade)

  @@map("events")
  @@index([fechaDesde, fechaHasta])
  @@index([tipoEvento])
  @@index([area])
}